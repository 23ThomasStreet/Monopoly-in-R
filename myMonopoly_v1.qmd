---
title: "myMonopolyQuarto"
format: html
editor: visual
---

# myMonopoly v.1

The goal of this project is to simulate Monopoly in R in order to see if Georgist rules outperform the regular rules in tax-dollars collected and in the fairness of the game (meassured in how slowly the game reaches a state of monopoly).

```{r}

X11() # This sets the default device to X11

source("boardGraphics.R")

source("tileData.R")

#### Player A information ####
player_A_data <- data.frame(
  "money" = 1500,
  "color" = "thistle"
)

#### Player B information ####
player_B_data <- data.frame(
  "money" = 1500,
  "color" = "tan"
)

#### Game Logic ####
dice <- function(){
  dice_res <- sample(1:6, 2)
  dice_res <- sum(dice_res)
  return(dice_res)
}
movePlayer <- function(player_A){
  roll <- dice()
  updatePos <- player_A + roll
  
  points(gameBoard$XtileCoordinate[player_A], 
         gameBoard$YtileCoordinate[player_A],
         type = "p",
         pch = 16,
         col = "white")
  points(gameBoard$XtileCoordinate[updatePos], 
         gameBoard$YtileCoordinate[updatePos],
         type = "p",
         pch = 16,
         col = player_A_data$color) 
  player_A <- updatePos
  if (player_A > 40){
    points(gameBoard$XtileCoordinate[(player_A - updatePos)], 
           gameBoard$YtileCoordinate[(player_A - updatePos)],
           type = "p",
           pch = 16,
           col = "white")
    player_A <- player_A - 40
    points(gameBoard$XtileCoordinate[player_A], 
           gameBoard$YtileCoordinate[player_A],
           type = "p",
           pch = 16,
           col = player_A_data$color) 
    print("New GO!")
    player_A_data$money <<- player_A_data$money + 200
    return(player_A)
  } else if (player_A == 40){
    points(gameBoard$XtileCoordinate[player_A], 
           gameBoard$YtileCoordinate[player_A],
           type = "p",
           pch = 16,
           col = "white")
    player_A_data$money <<- player_A_data$money + 200
    player_A <- 1
    return(player_A)
  } else {
    return(player_A)
  }
}
# place player
player_A <- 1
points(gameBoard$XtileCoordinate[1], 
       gameBoard$YtileCoordinate[1],
       type = "p",
       pch = 16,
       col = player_A_data$color)

#### game loop ####
gameLoop <- function() {
  for (i in 1:1000) {
    
    print(
    c("tileNr:" = gameBoard$tileNr[player_A], 
      "tileType:" = gameBoard$tileType[player_A], 
      "ownedBy:" = gameBoard$ownedBy[player_A],
      "player_A money:" = player_A_data$money)
    )

    ## Stats Boiler plate [START] ## 
    text(
      1.05, 
      0.8, 
      "'tileNr':", 
      col = player_A_data$color, 
      cex = 0.95, 
    )
    text(
      1.11, 
      0.8, 
      gameBoard$tileNr[player_A], 
      col = "blue", 
      cex = 0.95, 
    )
    
    text(
      1.2, 
      0.8, 
      "'tileType':", 
      col = player_A_data$color, 
      cex = 0.95, 
    )
    text(
      1.32, 
      0.8, 
      gameBoard$tileType[player_A], 
      col = "blue", 
      cex = 0.95, 
    )
    
    text(
      1.08, 
      0.76, 
      "'ownedBy':", 
      col = player_A_data$color, 
      cex = 0.95, 
    )
    text(
      1.2, 
      0.76, 
      gameBoard$ownedBy[player_A], 
      col = "blue", 
      cex = 0.95, 
    )
    
    text(
      1.3, 
      0.76, 
      player_A_data$money, 
      col = "darkgreen", 
      cex = 0.95, 
    )
    text(
      1.38, 
      0.76, 
      "$", 
      col = "darkgreen", 
      cex = 0.95, 
    )
    ## Stats Boiler plate [END] ##
    
    if (gameBoard$tileType[player_A] == "I") {
      player_A_data$money <<- player_A_data$money - 200
      print("Action: pay income tax.")
      text(
        1.2, 
        0.85, 
        "Action: pay income tax.", 
        col = player_A_data$color, 
        cex = 0.95, 
      )
    } else if (gameBoard$tileType[player_A] == "S") {
      player_A_data$money <<- player_A_data$money - 100
      print("Action: pay super tax.")
      text(
        1.2, 
        0.85, 
        "Action: pay super tax.", 
        col = player_A_data$color, 
        cex = 0.95, 
      )
    } else if (gameBoard$tileType[player_A] == "GT_J") {
      print("Action: go to jail!")
      text(
        1.2, 
        0.85, 
        "Action: go to jail!", 
        col = player_A_data$color, 
        cex = 0.95, 
      )
      points(gameBoard$XtileCoordinate[player_A], 
             gameBoard$YtileCoordinate[player_A],
             type = "p",
             pch = 16,
             col = "white")
      player_A <- 11
      points(gameBoard$XtileCoordinate[player_A], 
             gameBoard$YtileCoordinate[player_A],
             type = "p",
             pch = 16,
             col = player_A_data$color)
    } else if (gameBoard$ownedBy[player_A] == "none" 
    &
    player_A_data$money >= gameBoard$tileCost[player_A]){
      ## Buy graphics [START] ##
      print("Action: buy.")
      text(
        1.2, 
        0.85, 
        "Action: buy.", 
        col = player_A_data$color, 
        cex = 0.95, 
      )
      
      a <- masterTileList[[player_A]][1]
      b <- masterTileList[[player_A]][2]
      
      if (gameBoard$tileNr[player_A] <= 11) {
        polygon(
          c(a[[1]][1], 
            a[[1]][3], 
            a[[1]][2],
            a[[1]][4]),
        
          c(b[[1]][1],
            b[[1]][2],
            b[[1]][3], 
            b[[1]][4]),
        
            col = player_A_data$color,
            border = "black"
          )
        
      } else if (gameBoard$tileNr[player_A] >= 12 
             & 
             gameBoard$tileNr[player_A]<= 21) {
        polygon(
          c(a[[1]][4], 
            a[[1]][1], 
            a[[1]][2],
            a[[1]][3]),
      
          c(b[[1]][2],
            b[[1]][4],
            b[[1]][3], 
            b[[1]][1]),
      
          col = player_A_data$color,
          border = "black"
          )
    
      } else if (gameBoard$tileNr[player_A] >= 21 
             & 
             gameBoard$tileNr[player_A]<= 31) {
        polygon(
          c(a[[1]][1], 
            a[[1]][3], 
            a[[1]][2],
            a[[1]][4]),
      
          c(b[[1]][1],
            b[[1]][2],
            b[[1]][3], 
            b[[1]][4]),
      
          col = player_A_data$color,
          border = "black"
          )
    
      } else {
        polygon(
          c(a[[1]][4], 
            a[[1]][1], 
            a[[1]][2],
            a[[1]][3]),
      
          c(b[[1]][2],
            b[[1]][4],
            b[[1]][3], 
            b[[1]][1]),
      
          col = player_A_data$color,
          border = "black"
        )
        }
  
      player_A_data$money <<- player_A_data$money -
      gameBoard$tileCost[player_A]
  
      gameBoard$ownedBy[player_A] <<- "player_A"
      
      } else if (sum(gameBoard$tileType[gameBoard$ownedBy == "player_A"] 
        == gameBoard$tileType[player_A]) == 3){
        
        cat("You got a full colour group in",    
        gameBoard$tileType[player_A])
        
        if (gameBoard$tileNr[player_A] <= 11) {
          
          if (gameBoard$property_player_A[player_A] == "0" 
              & 
              player_A_data$money >= gameBoard$house_1_Cost[player_A]) {
            
            text(
              gameBoard$XtileCoordinate[player_A], 
              gameBoard$YtileCoordinate[player_A] + 0.035, 
              "1", 
              col = "green", 
              cex = 0.95, 
              )
            gameBoard$property_player_A[player_A] <<- "1"
          
          } else if (gameBoard$property_player_A[player_A] == "1" 
                     & 
                     player_A_data$money >= gameBoard$house_2_Cost[player_A]
                     ) {
            text(
              gameBoard$XtileCoordinate[player_A], 
              gameBoard$YtileCoordinate[player_A] + 0.035, 
              "1", 
              col = player_A_data$color, 
              cex = 0.95, 
              )
            text(
              gameBoard$XtileCoordinate[player_A], 
              gameBoard$YtileCoordinate[player_A] + 0.035, 
              "2", 
              col = "green", 
              cex = 0.95, 
              )
            gameBoard$property_player_A[player_A] <<- "2"
          
          } else if (gameBoard$property_player_A[player_A] == "2" 
                     & 
                     player_A_data$money >= gameBoard$house_3_Cost[player_A]
                     ) {
            text(
              gameBoard$XtileCoordinate[player_A], 
              gameBoard$YtileCoordinate[player_A] + 0.035, 
              "2", 
              col = player_A_data$color, 
              cex = 0.95, 
              )
            text(
              gameBoard$XtileCoordinate[player_A], 
              gameBoard$YtileCoordinate[player_A] + 0.035, 
              "3", 
              col = "green", 
              cex = 0.95, 
              )
            gameBoard$property_player_A[player_A] <<- "3"
          
          } else if (gameBoard$property_player_A[player_A] == "3" 
                     & 
                     player_A_data$money >= gameBoard$house_4_Cost[player_A]
                     ) {
            text(
              gameBoard$XtileCoordinate[player_A], 
              gameBoard$YtileCoordinate[player_A] + 0.035, 
              "3", 
              col = player_A_data$color, 
              cex = 0.95, 
              )
            text(
              gameBoard$XtileCoordinate[player_A], 
              gameBoard$YtileCoordinate[player_A] + 0.035, 
              "4", 
              col = "green", 
              cex = 0.95, 
              )
            gameBoard$property_player_A[player_A] <<- "4"
          
          } else if (gameBoard$property_player_A[player_A] == "4" 
                     & 
                     player_A_data$money >= gameBoard$house_hotel_Cost[player_A]
                     ) {
            text(
              gameBoard$XtileCoordinate[player_A], 
              gameBoard$YtileCoordinate[player_A] + 0.035, 
              "4", 
              col = player_A_data$color, 
              cex = 0.95, 
              )
            text(
              gameBoard$XtileCoordinate[player_A], 
              gameBoard$YtileCoordinate[player_A] + 0.035, 
              "H", 
              col = "red", 
              cex = 0.95, 
              )
            gameBoard$property_player_A[player_A] <<- "H"
          
          }
    
          
        } else if (gameBoard$tileNr[player_A] >= 12 
             & 
             gameBoard$tileNr[player_A]<= 21) {
          
          if (gameBoard$property_player_A[player_A] == "0" 
              & 
              player_A_data$money >= gameBoard$house_1_Cost[player_A]) {
            
            text(
              gameBoard$XtileCoordinate[player_A] + 0.035, 
              gameBoard$YtileCoordinate[player_A], 
              "1", 
              col = "green", 
              cex = 0.95, 
              srt = 90
              )
            gameBoard$property_player_A[player_A] <<- "1"
          
          } else if (gameBoard$property_player_A[player_A] == "1" 
                     & 
                     player_A_data$money >= gameBoard$house_2_Cost[player_A]
                     ) {
            text(
              gameBoard$XtileCoordinate[player_A] + 0.035, 
              gameBoard$YtileCoordinate[player_A], 
              "1", 
              col = player_A_data$color, 
              cex = 0.95, 
              srt = 90
              )
            text(
              gameBoard$XtileCoordinate[player_A] + 0.035, 
              gameBoard$YtileCoordinate[player_A], 
              "2", 
              col = "green", 
              cex = 0.95, 
              srt = 90
              )
            gameBoard$property_player_A[player_A] <<- "2"
          
          } else if (gameBoard$property_player_A[player_A] == "2" 
                     & 
                     player_A_data$money >= gameBoard$house_3_Cost[player_A]
                     ) {
            text(
              gameBoard$XtileCoordinate[player_A] + 0.035, 
              gameBoard$YtileCoordinate[player_A], 
              "2", 
              col = player_A_data$color, 
              cex = 0.95, 
              srt = 90
              )
            text(
              gameBoard$XtileCoordinate[player_A] + 0.035, 
              gameBoard$YtileCoordinate[player_A], 
              "3", 
              col = "green", 
              cex = 0.95, 
              srt = 90
              )
            gameBoard$property_player_A[player_A] <<- "3"
          
          } else if (gameBoard$property_player_A[player_A] == "3" 
                     & 
                     player_A_data$money >= gameBoard$house_4_Cost[player_A]
                     ) {
            text(
              gameBoard$XtileCoordinate[player_A] + 0.035, 
              gameBoard$YtileCoordinate[player_A], 
              "3", 
              col = player_A_data$color, 
              cex = 0.95, 
              srt = 90
              )
            text(
              gameBoard$XtileCoordinate[player_A] + 0.035, 
              gameBoard$YtileCoordinate[player_A], 
              "4", 
              col = "green", 
              cex = 0.95, 
              srt = 90
              )
            gameBoard$property_player_A[player_A] <<- "4"
          
          } else if (gameBoard$property_player_A[player_A] == "4" 
                     & 
                     player_A_data$money >= gameBoard$house_hotel_Cost[player_A]
                     ) {
            text(
              gameBoard$XtileCoordinate[player_A] + 0.035, 
              gameBoard$YtileCoordinate[player_A], 
              "4", 
              col = player_A_data$color, 
              cex = 0.95, 
              srt = 90
              )
            text(
              gameBoard$XtileCoordinate[player_A] + 0.035, 
              gameBoard$YtileCoordinate[player_A], 
              "H", 
              col = "red", 
              cex = 0.95, 
              srt = 90
              )
            gameBoard$property_player_A[player_A] <<- "H"
          
          }
          
        } else if (gameBoard$tileNr[player_A] >= 21 
             & 
             gameBoard$tileNr[player_A]<= 31) {
          
          if (gameBoard$property_player_A[player_A] == "0" 
              & 
              player_A_data$money >= gameBoard$house_1_Cost[player_A]) {
            
            text(
              gameBoard$XtileCoordinate[player_A], 
              gameBoard$YtileCoordinate[player_A] - 0.035, 
              "1", 
              col = "green", 
              cex = 0.95, 
              )
            gameBoard$property_player_A[player_A] <<- "1"
          
          } else if (gameBoard$property_player_A[player_A] == "1" 
                     & 
                     player_A_data$money >= gameBoard$house_2_Cost[player_A]
                     ) {
            text(
              gameBoard$XtileCoordinate[player_A], 
              gameBoard$YtileCoordinate[player_A] - 0.035, 
              "1", 
              col = player_A_data$color, 
              cex = 0.95, 
              )
            text(
              gameBoard$XtileCoordinate[player_A], 
              gameBoard$YtileCoordinate[player_A] - 0.035, 
              "2", 
              col = "green", 
              cex = 0.95, 
              )
            gameBoard$property_player_A[player_A] <<- "2"
          
          } else if (gameBoard$property_player_A[player_A] == "2" 
                     & 
                     player_A_data$money >= gameBoard$house_3_Cost[player_A]
                     ) {
            text(
              gameBoard$XtileCoordinate[player_A], 
              gameBoard$YtileCoordinate[player_A] - 0.035, 
              "2", 
              col = player_A_data$color, 
              cex = 0.95, 
              )
            text(
              gameBoard$XtileCoordinate[player_A], 
              gameBoard$YtileCoordinate[player_A] - 0.035, 
              "3", 
              col = "green", 
              cex = 0.95, 
              )
            gameBoard$property_player_A[player_A] <<- "3"
          
          } else if (gameBoard$property_player_A[player_A] == "3" 
                     & 
                     player_A_data$money >= gameBoard$house_4_Cost[player_A]
                     ) {
            text(
              gameBoard$XtileCoordinate[player_A], 
              gameBoard$YtileCoordinate[player_A] - 0.035, 
              "3", 
              col = player_A_data$color, 
              cex = 0.95, 
              )
            text(
              gameBoard$XtileCoordinate[player_A], 
              gameBoard$YtileCoordinate[player_A] - 0.035, 
              "4", 
              col = "green", 
              cex = 0.95, 
              )
            gameBoard$property_player_A[player_A] <<- "4"
          
          } else if (gameBoard$property_player_A[player_A] == "4" 
                     & 
                     player_A_data$money >= gameBoard$house_hotel_Cost[player_A]
                     ) {
            text(
              gameBoard$XtileCoordinate[player_A], 
              gameBoard$YtileCoordinate[player_A] - 0.035, 
              "4", 
              col = player_A_data$color, 
              cex = 0.95, 
              )
            text(
              gameBoard$XtileCoordinate[player_A], 
              gameBoard$YtileCoordinate[player_A] - 0.035, 
              "H", 
              col = "red", 
              cex = 0.95, 
              )
            gameBoard$property_player_A[player_A] <<- "H"
          
          }
          
        } else {
          
          if (gameBoard$property_player_A[player_A] == "0" 
              & 
              player_A_data$money >= gameBoard$house_1_Cost[player_A]) {
            
            text(
              gameBoard$XtileCoordinate[player_A] - 0.035, 
              gameBoard$YtileCoordinate[player_A], 
              "1", 
              col = "green", 
              cex = 0.95, 
              srt = 270
              )
            gameBoard$property_player_A[player_A] <<- "1"
          
          } else if (gameBoard$property_player_A[player_A] == "1" 
                     & 
                     player_A_data$money >= gameBoard$house_2_Cost[player_A]
                     ) {
            text(
              gameBoard$XtileCoordinate[player_A] - 0.035, 
              gameBoard$YtileCoordinate[player_A], 
              "1", 
              col = player_A_data$color, 
              cex = 0.95, 
              srt = 270
              )
            text(
              gameBoard$XtileCoordinate[player_A] - 0.035, 
              gameBoard$YtileCoordinate[player_A], 
              "2", 
              col = "green", 
              cex = 0.95, 
              srt = 270
              )
            gameBoard$property_player_A[player_A] <<- "2"
          
          } else if (gameBoard$property_player_A[player_A] == "2" 
                     & 
                     player_A_data$money >= gameBoard$house_3_Cost[player_A]
                     ) {
            text(
              gameBoard$XtileCoordinate[player_A] - 0.035, 
              gameBoard$YtileCoordinate[player_A], 
              "2", 
              col = player_A_data$color, 
              cex = 0.95, 
              srt = 270
              )
            text(
              gameBoard$XtileCoordinate[player_A] - 0.035, 
              gameBoard$YtileCoordinate[player_A], 
              "3", 
              col = "green", 
              cex = 0.95, 
              srt = 270
              )
            gameBoard$property_player_A[player_A] <<- "3"
          
          } else if (gameBoard$property_player_A[player_A] == "3" 
                     & 
                     player_A_data$money >= gameBoard$house_4_Cost[player_A]
                     ) {
            text(
              gameBoard$XtileCoordinate[player_A] - 0.035, 
              gameBoard$YtileCoordinate[player_A], 
              "3", 
              col = player_A_data$color, 
              cex = 0.95, 
              srt = 270
              )
            text(
              gameBoard$XtileCoordinate[player_A] - 0.035, 
              gameBoard$YtileCoordinate[player_A], 
              "4", 
              col = "green", 
              cex = 0.95, 
              srt = 270
              )
            gameBoard$property_player_A[player_A] <<- "4"
          
          } else if (gameBoard$property_player_A[player_A] == "4" 
                     & 
                     player_A_data$money >= gameBoard$house_hotel_Cost[player_A]
                     ) {
            text(
              gameBoard$XtileCoordinate[player_A] - 0.035, 
              gameBoard$YtileCoordinate[player_A], 
              "4", 
              col = player_A_data$color, 
              cex = 0.95, 
              srt = 270
              )
            text(
              gameBoard$XtileCoordinate[player_A] - 0.035, 
              gameBoard$YtileCoordinate[player_A], 
              "H", 
              col = "red", 
              cex = 0.95, 
              srt = 270
              )
            gameBoard$property_player_A[player_A] <<- "H"
          
          }
          
        }
        

      } else {
        print("Action: too expensive.")
        text(
          1.2, 
          0.85, 
          "Action: too expensive.", 
          col = player_A_data$color, 
          cex = 0.95, 
        )
      } ## Buy graphics [END] ##
    
    Sys.sleep(0.5)
    
    # clear text #
    polygon(
    c(1, 1.4, 1.4, 1), 
    c(0.95, 0.95, 0.725, 0.725),
    col = "white",
    border = "white"
    )
    
    # update player_A position #
    player_A <- movePlayer(player_A)
  }
}


# Better to loop function rather than have loop inside function to
# enable two players taking turns.
gameLoop()

```
